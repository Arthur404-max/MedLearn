# Правила валидации формы регистрации

## Цель валидации

Предотвратить проблемы с кодировкой кириллицы в PostgreSQL и обеспечить совместимость данных между различными системами.

---

## Правила валидации полей

### Имя (First Name)

Разрешено:
- Только английские буквы A-Z, a-z

Запрещено:
- Кириллица
- Цифры
- Спецсимволы
- Пробелы

Минимальная длина: 1 символ

Регулярное выражение: `^[A-Za-z]+$`

Примеры:
- John (правильно)
- Mary (правильно)
- Alexander (правильно)
- Иван (ошибка - кириллица)
- John123 (ошибка - содержит цифры)
- Mary-Ann (ошибка - содержит дефис)

---

### Фамилия (Last Name)

Разрешено:
- Только английские буквы A-Z, a-z

Запрещено:
- Кириллица
- Цифры
- Спецсимволы
- Пробелы

Минимальная длина: 1 символ

Регулярное выражение: `^[A-Za-z]+$`

Примеры:
- Smith (правильно)
- Johnson (правильно)
- Williams (правильно)
- Петров (ошибка - кириллица)
- Smith123 (ошибка - содержит цифры)
- O'Brien (ошибка - содержит апостроф)

---

### Пароль (Password)

Разрешено:
- Английские буквы A-Z, a-z
- Цифры 0-9
- Спецсимволы: !@#$%^&*()_+-=[]{};\:"|,.<>/?

Запрещено:
- Кириллица
- Другие Unicode символы

Минимальная длина: 6 символов

Регулярное выражение: `^[A-Za-z0-9!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+$`

Примеры:
- Test123! (правильно)
- MyPass@2025 (правильно)
- SecureP@ssw0rd (правильно)
- simple (правильно - минимум 6 символов)
- Пароль123 (ошибка - кириллица)
- test (ошибка - менее 6 символов)

---

### Email

Разрешено:
- Стандартный формат email

Формат: name@domain.com

Примеры:
- test@medlearn.ru (правильно)
- john.smith@gmail.com (правильно)
- student123@university.edu (правильно)

---

## Уровни валидации

### 1. Frontend (HTML)

Базовая валидация на уровне HTML5:

```html
<!-- Имя -->
<input type="text" pattern="[A-Za-z]+" title="Только английские буквы">

<!-- Пароль -->
<input type="password" minlength="6" 
  pattern="[A-Za-z0-9!@#$%^&*()_+\-=\[\]{};':&quot;\\|,.<>\/? ]+">
```

### 2. Frontend (JavaScript)

Валидация в реальном времени:

```javascript
// Регулярные выражения
const nameRegex = /^[A-Za-z]+$/;
const passwordRegex = /^[A-Za-z0-9!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+$/;

// Визуальная индикация
input.style.borderColor = isValid ? '#10b981' : '#e74c3c';
```

### 3. Backend (Express/TypeScript)

Финальная валидация перед сохранением в БД:

```typescript
const nameRegex = /^[A-Za-z]+$/;
const passwordRegex = /^[A-Za-z0-9!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+$/;

if (!nameRegex.test(firstName)) {
  return res.status(400).json({ 
    message: 'Имя должно содержать только английские буквы' 
  });
}
```

---

## Визуальная индикация

### Цвета границ полей

- Зеленый (#10b981) - корректное значение
- Красный (#e74c3c) - ошибка валидации
- Оранжевый (#f39c12) - предупреждение
- Серый (по умолчанию) - поле не заполнено

### Сообщения об ошибках

```javascript
"Имя должно содержать только английские буквы (A-Z)"
"Фамилия должна содержать только английские буквы (A-Z)"
"Пароль должен содержать минимум 6 символов"
"Пароль должен содержать только английские буквы, цифры и спецсимволы"
"Пароли не совпадают"
```

---

## Файлы с валидацией

Frontend:
1. public/register.html - HTML5 валидация (pattern, minlength)
2. public/client.js - валидация при submit формы
3. public/register-validation.js - валидация в реальном времени

Backend:
1. routes/auth.ts - серверная валидация перед INSERT

---

## Тестовые данные

### Корректные данные

```json
{
  "firstName": "John",
  "lastName": "Smith",
  "email": "john.smith@test.com",
  "password": "SecurePass123!"
}
```

### Некорректные данные

```json
{
  "firstName": "Иван",           // Ошибка: кириллица
  "lastName": "O'Brien",        // Ошибка: спецсимвол
  "email": "invalid-email",     // Ошибка: некорректный email
  "password": "test"            // Ошибка: менее 6 символов
}
```

---

## Примеры API запросов

### Успешная регистрация

```powershell
Invoke-RestMethod -Uri "http://localhost:3000/api/auth/register" `
  -Method POST `
  -ContentType "application/json" `
  -Body (@{
      email = "john@test.com"
      password = "Test123!"
      firstName = "John"
      lastName = "Smith"
  } | ConvertTo-Json)
```

### Регистрация с ошибкой валидации

```powershell
Invoke-RestMethod -Uri "http://localhost:3000/api/auth/register" `
  -Method POST `
  -ContentType "application/json" `
  -Body (@{
      email = "ivan@test.com"
      password = "Test123!"
      firstName = "Иван"
      lastName = "Петров"
  } | ConvertTo-Json)
```

Ответ сервера:
```json
{
  "message": "Имя должно содержать только английские буквы (A-Z)"
}
```

---

Обновлено: октябрь 2025  
Версия: 1.3.0
